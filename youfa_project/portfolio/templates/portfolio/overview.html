{% extends 'core/base.html' %} {% load static %} {% block content %}

<div class="container mt-5">
  <h2 class="mb-4 text-center">Il tuo Portafoglio</h2>

  <!-- Saldo e Capitale investito -->
  <div class="mb-4 p-3 border rounded bg-light text-dark">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <div class="fw-semibold fs-5">Saldo disponibile</div>
        <small class="text-secondary">Totale attualmente non investito</small>
      </div>
      <div class="fw-bold fs-4 text-success" id="available-balance">
        $ {{ saldo }}
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center mt-3">
      <div>
        <div class="fw-semibold fs-5">Capitale investito</div>
        <small class="text-secondary"
          >Valore attuale degli asset posseduti</small
        >
      </div>
      <div class="fw-bold fs-4 text-primary" id="invested-capital">$ 0.00</div>
    </div>
  </div>

  <!-- Tabella asset -->
  <div class="table-responsive mb-5">
    <table class="table table-hover table-bordered align-middle text-center">
      <thead class="table-light">
        <tr class="align-middle">
          <th>Ticker</th>
          <th>Quantit√†</th>
          <th>Prezzo Medio</th>
          <th>Prezzo Attuale</th>
          <th>Valore Totale</th>
        </tr>
      </thead>
      <tbody>
        {% for item in assets %}
        <tr>
          <td class="fw-semibold">{{ item.ticker }}</td>
          <td>{{ item.quantity }}</td>
          <td>$ {{ item.avg_price|floatformat:2 }}</td>
          <td
            class="current-price text-secondary"
            data-ticker="{{ item.ticker }}"
          >
            -
          </td>
          <td
            class="total-value fw-semibold text-dark"
            data-ticker="{{ item.ticker }}"
            data-quantity="{{ item.quantity }}"
          >
            -
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="text-center text-muted">
            Nessun asset in portafoglio
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Grafico a torta: composizione portafoglio -->
  <div class="mb-4">
    <h5 class="text-center">Composizione del portafoglio</h5>
    <canvas id="portfolioPieChart" height="300"></canvas>
  </div>
</div>

{% endblock %} {% block extra_js %}
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
  crossorigin="anonymous"
></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'portfolio/js/portfolio.js' %}"></script>
{% endblock %}
